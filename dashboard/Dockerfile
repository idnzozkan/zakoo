FROM node:16.14.0-alpine3.14 AS BUILDER

ARG REACT_APP_FIREBASE_API_KEY
ARG REACT_APP_FIREBASE_AUTH_DOMAIN
ARG REACT_APP_FIREBASE_PROJECT_ID
ARG REACT_APP_FIREBASE_STORAGE_BUCKET
ARG REACT_APP_FIREBASE_MESSAGING_SENDER_ID
ARG REACT_APP_FIREBASE_APP_ID
ARG REACT_APP_FIREBASE_MEASUREMENT_ID

WORKDIR /app

COPY package.json package-lock.json ./

RUN npm install 

COPY . .

RUN npm run build

# Stage 2
FROM node:16.14.0-alpine3.14

WORKDIR /app

RUN npm install -g serve

COPY --from=BUILDER /app/build .

EXPOSE 3000

CMD serve -s -n